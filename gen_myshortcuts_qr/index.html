<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">

<title>Generate Myshortcuts+Viewer QRCode</title>

<link rel="stylesheet" href="css/uikit.min.css">
</head>
<body>
<div class="uk-container uk-container-center">
  <div class="uk-grid uk-article" data-uk-grid-margin>
    <h1 class="uk-article-title">Generate Myshortcuts+Viewer QRCode</h1>
    <p class="uk-article-lead">
      Myshortcuts+Viewerのメモに内容を追加できるQRコードを生成します。iPhoneで生成されたQRコードを読み取れば、Myshortcuts+Viewerに登録することができます。iPhoneで入力するのが面倒くさい人向け。
    </p>
  </div>
  <div class="uk-grid uk-grid-divider" data-uk-grid-match data-uk-grid-margin>
    <div id="code-area" class="uk-width-medium-7-10 uk-width-small-1-1">
      <div class="uk-grid">
        <div class="uk-width-medium-1-1">
          <p class="uk-text-bold uk-text-top">1. メモを入力</p>
          <form class="uk-form">
            <textarea id="code" name="code" class="uk-width-1-1" rows="15" placeholder="ここにメモを入力してください。"></textarea>
          </form>
        </div>
        <div id="action-area" class="uk-width-medium-1-1 ">
          <button id="generate" class="uk-button uk-button-primary uk-width-1-1 uk-button-large">QRコード作成</button>
        </div>
      </div>
    </div>
    <div class="uk-width-medium-3-10 uk-width-small-1-1">
      <p class="uk-text-bold uk-text-top">2. ここにQRコードが生成されます。</p>
      <div id="qrcode" class="uk-thumbnail uk-thumbnail-expand"></div>
    </div>
  </div>
</div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="js/uikit.min.js"></script>
<script src="js/qrcode.min.js"></script>
<script>
$(function () {

  var qrcode = new QRCode("qrcode");

  var generateQR = function () {
    var code = $('#code').val() || '';
    var base_url = 'myshortcuts://memo?add=';
    var url;

    if (code == '') {
      $('#code').addClass('uk-animation-shake');
      setTimeout(function () {
        $('#code').focus();
        return false;
      }, 500)
    } else {
      code = code.replace(/¥n/g, '');
      url = base_url + encodeURI(code);
      qrcode.makeCode(url);
    }
  };

  $('#code').on('focus', function () {
    $(this).removeClass('uk-animation-shake');
  });

  $('#generate').on('click', function () {
    generateQR();
  });

});
</script>
</body>
</html>